[
["第6章-平均値差と連関に関する推測.html", "第6章 平均値差と連関に関する推測 ", " 第6章 平均値差と連関に関する推測 "],
["t分布を用いた正確な検定p-161-163.html", "6.1.1 \\(t\\)分布を用いた正確な検定(p.161-163)", " 6.1.1 \\(t\\)分布を用いた正確な検定(p.161-163) 教科書に従って逸脱行動データの男子を第1群，女子を第2群として平均値差の検定を行いましょう。 まずは逸脱行動データを読み込みます。男子はdat_M，女子はdat_Fというオブジェクトに代入します。 dat &lt;- read.csv(file = &quot;data/itsudatsu_data.csv&quot;) dat_M &lt;- subset(dat, sex == 1) dat_F &lt;- subset(dat, sex == 2) 変化量の平均値差を求めます。 mean(dat_M$diff) ## [1] 1.95 mean(dat_F$diff) ## [1] 4.55 mean(dat_M$diff) -mean(dat_F$diff) ## [1] -2.6 (6.4)式による郡内の標準偏差の推定値を計算します(\\(s ^{\\ast}\\)はs_astというオブジェクトに代入しています)。 var_M &lt;- mean((dat_M$diff - mean(dat_M$diff))^2) var_F &lt;- mean((dat_F$diff - mean(dat_F$diff))^2) var_M ## [1] 11.9475 var_F ## [1] 9.7475 s_ast &lt;- sqrt((20 * var_M + 20 * var_F)/ (20 + 20 -2)) s_ast ## [1] 3.379115 平均値差の標準誤差の推定値を計算します。 s_ast * sqrt((1/20) + (1/20)) ## [1] 1.06857 (6.7)式の検定統計量\\(t\\)を計算します。 \\[ t = \\frac{\\bar{y} _{1} - \\bar{y} _{2}}{s _{\\bar{y} _{1}} - s _{\\bar{y} _{2}}} \\tag{6.7}\\\\ \\] (mean(dat_M$diff) - mean(dat_F$diff)) / (s_ast * sqrt((1/20) + (1/20))) ## [1] -2.433158 教科書の付表4から自由度\\(20 + 20 - 2 = 38\\)の\\(t\\)分布の上側確率\\(.025\\)に対応する値は\\(2.024\\)とわかります。 自由度38の\\(t\\)分布がどのような形をしているか確認してみましょう。\\(t\\)分布の確率密度関数はdt()という関数で用意されています(t分布の確率密度という意味です，正規分布の時はdnorm()関数になります)。 dt()関数は第1引数に確率密度を求めたい値，第2引数dfに自由度を指定します。?dtとコンソールに入力してヘルプを確認してください。 x &lt;- seq(-5, 5, 0.01) plot(x, dt(x, df = 38), type = &quot;l&quot;, las = 1, bty = &quot;l&quot;, tcl = 0.2, xlab = &quot;t&quot;, ylab = &quot;確率密度&quot;) \\(t\\)分布の上側確率.025に対応する値を計算するにはpt()関数を使います。 qt()関数は第1引数に確率，第2引数dfに自由度を指定します。有意水準\\(.05\\)の両側検定であれば，第1引数に\\((1 - 0.05) / 2 = 0.975\\)という値を指定します。 qt(0.975, df = 38) ## [1] 2.024394 付表4と同じ\\(2.024\\)という値が表示されます。 先ほど求めた\\(t\\)値の絶対値は2.024よりも大きいので有意水準\\(.05\\)の両側検定において統計的に有意な差があったといえます。 付表4から読み取った2.024という値は実際に計算で求めることができます。正規分布において下側確率を計算する関数はprnom()関数，下側確率に対応する値を計算する関数はqnorm()関数でした(5章を確認してください)。 Rでは，\\(t\\)分布の下側確率を求めるpt()関数や下側確率に対応する値を求めるqt()関数があらかじめ用意されています。 自由度38の\\(t\\)分布における上側確率.025に対応する値が2.024か求めてみましょう。 qt(0.975, df = 38) ## [1] 2.024394 付表4と同じ値が計算できました。 5章では相関係数の検定を行うため，cor.test()関数を使う方法を紹介しました。cor.test()と同じように，Rには\\(t\\)検定を行うため，t.test()関数が用意されています。 コンソールで?t.testと入力し，ヘルプを確認してください。第1引数xには第1群のデータ，第2引数yには第2群のデータをそれぞれ指定します。 第3引数alternativeには両側検定か片側検定かを指定します。デフォルトでは両側検定を表す“two.sided”が指定されています。 本章では，2群の分散は等しいと仮定(教科書p.158)しているため，引数のvar.equalはvar.equal = TRUEとします。var.equalは2群の分散が等しいと仮定しているか，仮定していないかを指定します。デフォルトでは等分散性を仮定しない検定を行う設定(var.equal = FALSE)となっています。 t.test(dat_M$diff, dat_F$diff, alternative = &quot;two.sided&quot;, var.equal = TRUE) ## ## Two Sample t-test ## ## data: dat_M$diff and dat_F$diff ## t = -2.4332, df = 38, p-value = 0.01978 ## alternative hypothesis: true difference in means is not equal to 0 ## 95 percent confidence interval: ## -4.7632071 -0.4367929 ## sample estimates: ## mean of x mean of y ## 1.95 4.55 出力結果のうち，tが\\(t\\)値を示しています。先ほど計算した\\(t\\)値と同じ結果になっていることが確認できます。p-valueを確認すると0.05よりも値が小さいので，有意水準\\(.05\\)の両側検定において，統計的に有意であることがわかります。 "],
["効果量を用いた検定p-164.html", "6.1.2 効果量を用いた検定(p.164)", " 6.1.2 効果量を用いた検定(p.164) 逸脱行動データにおける効果量\\(d\\)を計算します。 \\[ d = \\frac{\\bar{y} _{1} - \\bar{y} _{2}}{s ^{\\ast}}\\tag{6.9}\\\\ \\] d &lt;- (mean(dat_M$diff) - mean(dat_F$diff)) / s_ast d ## [1] -0.7694321 付表6からサンプルサイズが各群20の時には\\(d\\)の絶対値が0.640を超えていれば統計的に有意となります。 付表6から読み取った0.640という値はどのように計算された値か確認します。 教科書p.163の「\\(t\\)統計量のなりたち」にある(6.8)式を再掲します。 \\[ \\begin{align} t &amp;= d \\times \\sqrt{\\frac{n _{1} n _{2}}{n _{1} + n _{2}}}\\tag{6.8}\\\\ \\end{align} \\] (6.8)式より，\\(t\\)統計量は効果量\\(d\\)にサンプルサイズで規定される値をかけたものになります。よって(6.8)式を効果量\\(d\\)の式に変形すると以下のようになります(サンプルサイズが等しいときの変形を用いています)。 \\[ \\begin{align} t &amp;= d \\times \\sqrt{\\frac{n}{2}}\\\\ d &amp;= t \\times \\frac{1}{\\sqrt{\\frac{n}{2}}}\\\\ &amp; = t \\times \\sqrt{\\frac{2}{n}} \\end{align} \\] \\(t\\)値に\\(\\sqrt{\\frac{2}{n}}\\)をかけることで効果量\\(d\\)の値に変換することができます。 上記の式変形を用いて，各群のサンプルサイズが20の時の棄却の限界値を求めます。 確率に対応する値を求めるにはqt()関数を使います。今回は両側検定なので，求める確率は0.975です。 qt(0.975, df = 38) * sqrt(2/20) ## [1] 0.6401696 自由度38(20 + 20 - 2)の\\(t\\)分布における上側.025に対応する\\(t\\)値にサンプルサイズで規定される値をかけることで付表6と同じ値を計算できました。 "],
["検定力とサンプルサイズp-164-166.html", "6.1.3 検定力とサンプルサイズ(p.164 - 166)", " 6.1.3 検定力とサンプルサイズ(p.164 - 166) 付図3のうち，教科書に登場した各群のサンプルサイズが20，母集団効果量\\(\\delta = 1\\)の時の検定力が0.87(87%)になるか確認します。 まず，両側検定を仮定しているので，母集団効果量\\(\\delta = 0\\)の時の上側.025に相当する\\(t\\)値をqt_Uというオブジェクトに代入します。 qt_U &lt;- qt(0.975, df = 38) qt_U ## [1] 2.024394 次に，自由度38，母集団効果量\\(\\delta = 1\\)の時のt分布において，t値がqt_U(2.0243942)よりも大きい確率を計算します。 教科書p.165より，帰無仮説が正しくない時(\\(\\delta \\neq 0\\))の\\(t\\)の分布は，非心\\(t\\)分布に従います。 Rで非心\\(t\\)分布は，これまで用いた\\(t\\)分布に関する関数の引数に非心度パラメータを指定することで計算することができます。 \\(t\\)分布の下側確率を求めるには，pt()関数を使います。 ?ptとコンソールに入力してヘルプを確認してください。引数(Arguments)の一覧にncpという引数があります。ncpはnon-centrality parameterの頭文字をとったものです。 非心\\(t\\)分布における非心度パラメータは \\[ \\frac{\\mu _{0} - \\mu}{\\sigma / \\sqrt{n}} \\] で表されます(引用元：[https://jp.mathworks.com/help/stats/noncentral-t-distribution.html]) 第6章では独立な2群について扱うので，非心度パラメータは以下のようになります。 \\[ \\begin{align} &amp;\\frac{\\mu _{1} - \\mu _{2}}{\\sigma / \\sqrt{1/n_{1} + 1/n _{2}}}\\\\ &amp;= \\frac{\\mu _{1} - \\mu _{2}}{\\sigma} \\times \\sqrt{\\frac{1}{n_{1}} + \\frac{1}{n _{2}}}\\\\ &amp;= \\frac{\\mu _{1} - \\mu _{2}}{\\sigma} \\times \\sqrt{\\frac{n _{1} n _{2}}{n_{1} + n _{2}}}\\\\ &amp;= \\frac{\\mu _{1} - \\mu _{2}}{\\sigma} \\times \\sqrt{\\frac{n}{2}}\\\\ &amp;= \\delta \\times \\sqrt{\\frac{n}{2}}\\\\ \\end{align} \\] ただし式中の変形には，サンプルサイズが等しいことを利用しています。式中の\\(\\delta\\)は教科書p.164の母集団効果量を表しています。 以上からpt()関数の非心度パラメータncpは母集団効果量\\(\\delta\\)に\\(\\sqrt{\\frac{n}{2}}\\)をかけたもの(サンプルサイズが等しい場合)となります。 今回は上側確率を計算するので，qt()関数の引数lower.tailはFALSEを指定してください。 pt(qt_U, df = 38, ncp = 1 * sqrt(20/2), lower.tail = FALSE) ## [1] 0.8689528 約87%となることがわかります。 自由度38，母集団効果量\\(\\delta = 1\\)の時の非心t分布を図示してみます。教科書p.165の図6-2を参考にして，\\(\\delta = 0\\)の分布を同時に図示します。 図中の垂線は\\(t\\)分布において上側.025に相当するt値を示しています。 x &lt;- seq(-6, 8, 0.01) plot(x, dt(x, df = 38, ncp = 0), type = &quot;l&quot;, las = 1, bty = &quot;l&quot;, tcl = 0.2, xlab = &quot;t&quot;, ylab = &quot;確率密度&quot;, col = &quot;red&quot;) lines(x, dt(x, df = 38, ncp = 1 * sqrt(20/2)), col = &quot;blue&quot;) abline(v = qt_U) 母集団効果量\\(\\delta = 0.5\\)の時の検定力を計算しましょう。これは図6-2の状況に相当します。 pt(qt_U, df = 38, ncp = 0.5 * sqrt(20/2), lower.tail = FALSE) ## [1] 0.3377084 教科書と同様に約34%となりました。 "],
["平均値差の区間推定p-167-168.html", "6.2.1 平均値差の区間推定(p.167 - 168)", " 6.2.1 平均値差の区間推定(p.167 - 168) 逸脱行動データで平均値差の区間推定を行いましょう。 dat &lt;- read.csv(file = &quot;data/itsudatsu_data.csv&quot;) dat_M &lt;- subset(dat, sex == 1) dat_F &lt;- subset(dat, sex == 2) mean(dat_M$diff) ## [1] 1.95 mean(dat_F$diff) ## [1] 4.55 mean(dat_M$diff) - mean(dat_F$diff) ## [1] -2.6 教科書p.168より，計算する式は以下の(6.13)式，(6.14)式になります。 \\[ \\begin{align} \\Delta _{L} = (\\bar{y} _{1} - \\bar{y} _{2}) - t _{c} \\times s _{\\bar{y} _{1} - \\bar{y} _{2}}\\tag{6.13}\\\\ \\Delta _{U} = (\\bar{y} _{1} - \\bar{y} _{2}) + t _{c} \\times s _{\\bar{y} _{1} - \\bar{y} _{2}}\\tag{6.14}\\\\ \\end{align} \\] \\(\\bar{y} _{1} - \\bar{y} _{2}\\)はmean(dat_M$diff) - mean(dat_F$diff)で計算することができます。 \\(t _{c}\\)はすでに求めたqt_Uが相当します(自由度38の\\(t\\)分布における上側確率.025に相当する値)。 \\(s _{\\bar{y} _{1} - \\bar{y} _{2}}\\)は教科書p.162で既に計算しています。 以上のオブジェクトを(6.13)式，(6.14)式に当てはめてみましょう。 delta_L &lt;- (mean(dat_M$diff) - mean(dat_F$diff)) - qt_U * (s_ast * sqrt((1/20) + (1/20))) delta_U &lt;- (mean(dat_M$diff) - mean(dat_F$diff)) + qt_U * (s_ast * sqrt((1/20) + (1/20))) delta_L ## [1] -4.763207 delta_U ## [1] -0.4367929 95%信頼区間は-4.7632071から-0.4367929となります。 95%信頼区間はt.test()関数で検定を行ったときに\\(t\\)値などと一緒に出力されています。もう一度t.test()関数の出力結果を確認しましょう。 t.test(dat_M$diff, dat_F$diff, var.equal = TRUE) ## ## Two Sample t-test ## ## data: dat_M$diff and dat_F$diff ## t = -2.4332, df = 38, p-value = 0.01978 ## alternative hypothesis: true difference in means is not equal to 0 ## 95 percent confidence interval: ## -4.7632071 -0.4367929 ## sample estimates: ## mean of x mean of y ## 1.95 4.55 出力結果の95 percent confidence interval:と表示されている箇所に数値が表示されています。先ほど計算したdelta_L，delta_Uと同じ値が表示されています。 "],
["効果量の区間推定p-168-170.html", "6.2.2 効果量の区間推定(p.168 - 170)", " 6.2.2 効果量の区間推定(p.168 - 170) 教科書(6.17)式，(6.18)式に従って母集団効果量\\(\\delta\\)の95%信頼区間を計算しましょう。 \\[ \\begin{align} s _{d} = \\sqrt{\\frac{n _{1} + n _{2}}{n _{1} n _{2}} + \\frac{d ^{2}}{2(n _{1} + n _{2} -2)}}\\tag{6.17}\\\\ (d - 1.96 \\ s _{d}, d + 1.96 \\ s _{d}) \\tag{6.18}\\\\ \\end{align} \\] \\(d\\)の標準誤差の推定値\\(s _{d}\\)を計算します。 ただし，dというオブジェクトには逸脱行動データの効果量(\\(d = -0.77\\))が代入されています。 d ## [1] -0.7694321 s_d &lt;- sqrt((2 / 20) + (d ^2 / (2 * 38))) s_d ## [1] 0.3283136 d - 1.96 * s_d ## [1] -1.412927 d + 1.96 * s_d ## [1] -0.1259375 教科書と同じ，(-1.4129268, -0.1259375)という値が計算できました。 "],
["帰無仮説の検定p-176-177.html", "6.3.1 帰無仮説の検定(p.176 - 177)", " 6.3.1 帰無仮説の検定(p.176 - 177) 教科書で表記される変化量\\(v\\)はdat_M$diffを表します。 対応のある2群の場合は，以下の\\(t\\)統計量が自由度\\(N - 1\\)の\\(t\\)分布に従うことが知られています。 \\[ \\begin{align} s _{\\bar{v}} = \\frac{s ^{\\prime} _{v}}{\\sqrt{N}}\\tag{6.25}\\\\ t = \\frac{\\bar{v} - \\mu _{v}}{s _{\\bar{v}}}\\tag{6.26}\\\\ \\end{align} \\] (6.25)式を計算します。 s_v &lt;- sd(dat_M$diff) / sqrt(20) s_v ## [1] 0.7929791 (6.26)式を計算します。 mean(dat_M$diff) / s_v ## [1] 2.459081 付表4より自由度20 - 1 = 19の\\(t\\)分布の上側確率.025に対応する値は2.093です。 計算された\\(t\\)値は2.093よりも大きいので，統計的に有意といえます。 対応のある\\(t\\)検定もt.test()関数を用いて行うことができます。教科書p.174には，「1つの変数\\(v\\)の平均の標本分布の問題に帰着する」とあります。 よって，t.test()関数に指定する値も，各対内の差\\(v\\)を指定すれば対応のある\\(t\\)検定を行うことができます。 t.test(dat_M$diff) ## ## One Sample t-test ## ## data: dat_M$diff ## t = 2.4591, df = 19, p-value = 0.02369 ## alternative hypothesis: true mean is not equal to 0 ## 95 percent confidence interval: ## 0.2902758 3.6097242 ## sample estimates: ## mean of x ## 1.95 \\(t\\)値を確認すると，先ほど計算した値と同じ値が表示されています。 上記の例は対応のある2群の変化量を求めている場合に，t.test()関数を用いた場合でした。対応のある2群それぞれの値を指定して対応のある\\(t\\)検定を行うこともできます。 コンソールに?t.testと入力してヘルプを確認してください。 引数一覧にある，pairedを確認してください。TRUEかFALSEかを指定することで2群に対応があるかないか指定することができます。デフォルトではFALSEになっています(先ほどまでの独立な2群の場合には指定していなかったのでデフォルトのFALSEとなっていました)。 対応のある\\(t\\)検定を行う場合には，paired = TRUEと指定してください。 t.test(dat_M$Grade_8th, dat_M$Grade_6th, paired = TRUE) ## ## Paired t-test ## ## data: dat_M$Grade_8th and dat_M$Grade_6th ## t = 2.4591, df = 19, p-value = 0.02369 ## alternative hypothesis: true difference in means is not equal to 0 ## 95 percent confidence interval: ## 0.2902758 3.6097242 ## sample estimates: ## mean of the differences ## 1.95 変化量に対して検定を行った時と全く同じ結果が表示されていることを確認してください。 "],
["平均値差の区間推定p-177-178.html", "6.3.2 平均値差の区間推定(p.177 - 178)", " 6.3.2 平均値差の区間推定(p.177 - 178) (6.30)式，(6.31)式に従って95%信頼区間を計算しましょう。 mean(dat_M$diff) - qt(0.975, df = 19) * (sd(dat_M$diff) / sqrt(20)) ## [1] 0.2902758 mean(dat_M$diff) + qt(0.975, df = 19) * (sd(dat_M$diff) / sqrt(20)) ## [1] 3.609724 教科書と同様の値が計算できました。また，先ほど計算したt.test()関数の95 percent confidence interval:とも全く同じ値が表示されていることを確認してください。 "],
["問題の例p-178-179.html", "6.4.1 問題の例(p.178 - 179)", " 6.4.1 問題の例(p.178 - 179) 表6-2のデータをdat_Aというオブジェクトに作成します。 dat_A &lt;- matrix(c(11, 9, 5, 15), ncol = 2, nrow = 2, byrow = TRUE) dimnames(dat_A) &lt;- list(c(&quot;男子&quot;,&quot;女子&quot;), c(&quot;ある&quot;,&quot;ない&quot;)) dat_A ## ある ない ## 男子 11 9 ## 女子 5 15 逸脱行動Aについて経験がある人の比率を計算します。 男子で「ある」と答えた人は1列1行目の11人なので，dat_A[1,1]と指定します。男子の合計は1列目の合計を求めるので，sum(dat_A[1,])となります。 p1 &lt;- dat_A[1,1] / sum(dat_A[1,]) p2 &lt;- dat_A[2,1] / sum(dat_A[2,]) p1 ## [1] 0.55 p2 ## [1] 0.25 "],
["独立な2群の比率差の検定p-180-181.html", "6.4.2 独立な2群の比率差の検定(p.180 - 181)", " 6.4.2 独立な2群の比率差の検定(p.180 - 181) (6.35)式から(6.37式)に従って比率差の検定を行います。 2群合わせた比率\\(p\\)を計算します。 prob &lt;- (11 + 5) / (20 + 20) prob ## [1] 0.4 検定統計量\\(z\\)を求めます。 z &lt;- (p1 - p2) / sqrt(prob * (1 - prob) * ((1 / 20) + (1 / 20))) z ## [1] 1.936492 標準正規分布の上側確率.025に対応する値は1.96なので，有意水準.05の両側検定で有意になりません。 "],
["対応のある2群の比率差の検定p-181-183.html", "6.4.3 対応のある2群の比率差の検定(p.181 - 183)", " 6.4.3 対応のある2群の比率差の検定(p.181 - 183) 表6-3のデータをdat_ABというオブジェクトに代入します。 dat_AB &lt;- matrix(c(12, 4, 10, 14), ncol = 2, nrow = 2, byrow = TRUE) dimnames(dat_AB) &lt;- list(c(&quot;A_ある&quot;, &quot;A_ない&quot;), c(&quot;B_ある&quot;, &quot;B_ない&quot;)) dat_AB ## B_ある B_ない ## A_ある 12 4 ## A_ない 10 14 (6.38)式に従って検定統計量\\(z\\)を計算します。\\(n_{12}\\)，および\\(n_{21}\\)の合計はmというオブジェクトに代入しています。 m &lt;- dat_AB[1,2] + dat_AB[2,1] (dat_AB[1,2] - m / 2) / (sqrt(m) / 2) ## [1] -1.603567 教科書と同じ-1.60という値が出力されます。この値の絶対値も標準正規分布における上側確率.025に対応する値1.96を超えないので，統計的に有意でないといえます。 "],
["カイ2乗統計量p-184-187.html", "6.5.1 カイ2乗統計量(p.184 - 187)", " 6.5.1 カイ2乗統計量(p.184 - 187) 表6-5のデータ(dat_AB)からカイ2乗統計量を計算します。 まずは各セルの推定期待度数を計算します(\\(e _{11}\\)の値はe11というオブジェクトに代入しています)。 e11 &lt;- (sum(dat_AB[1,]) * sum(dat_AB[,1])) / 40 e11 ## [1] 8.8 e12 &lt;- (sum(dat_AB[1,]) * sum(dat_AB[,2])) / 40 e21 &lt;- (sum(dat_AB[2,]) * sum(dat_AB[,1])) / 40 e22 &lt;- (sum(dat_AB[2,]) * sum(dat_AB[,2])) / 40 e12 ## [1] 7.2 e21 ## [1] 13.2 e22 ## [1] 10.8 カイ2乗統計量を計算します。 chi_sq &lt;- ((dat_AB[1,1] - e11) ^2 / e11) + ((dat_AB[1,2] - e12) ^2 / e12) + ((dat_AB[2,1] - e21) ^2 / e21) + ((dat_AB[2,2] - e22) ^2 / e22) chi_sq ## [1] 4.309764 教科書と同じ値が計算できました。 "],
["クラメルの連関係数とファイ係数p-187-188.html", "6.5.2 クラメルの連関係数とファイ係数(p.187 - 188)", " 6.5.2 クラメルの連関係数とファイ係数(p.187 - 188) (6.42)式に従ってクラメルの連関係数\\(V\\)を計算します。 V &lt;- sqrt(chi_sq / ((2 - 1) * 40)) V ## [1] 0.328244 (6.44)式に従ってファイ係数を計算します。 phi &lt;- (12 * 14 - 4 * 10) / sqrt(16 * 24 * 22 * 18) phi ## [1] 0.328244 表6-5は\\(2 \\times 2\\)のクロス集計表なのでクラメルの連関係数\\(V\\)とファイ係数の絶対値は一致します。 "],
["連関の検定p-188-189.html", "6.5.3 連関の検定(p.188 - 189)", " 6.5.3 連関の検定(p.188 - 189) カイ2乗分布の形を確認しましょう。カイ2乗分布も自由度によって規定される分布です。 自由度を1, 3, 5と変化させたときの分布の形状を作図します。 x &lt;- seq(0, 10, 0.01) plot(x, dchisq(x, df = 1), type = &quot;l&quot;, las = 1, bty = &quot;l&quot;, tcl = 0.2, ylim = c(0,0.5), xlab = &quot;chisq&quot;, ylab = &quot;確率密度&quot;, col = &quot;red&quot;) lines(x, dchisq(x, df = 3), col = &quot;blue&quot;) lines(x, dchisq(x, df = 5), col = &quot;green&quot;) legend(&quot;topright&quot;, legend = c(&quot;df = 1&quot;,&quot;df = 3&quot;, &quot;df = 5&quot;), col = c(&quot;red&quot;,&quot;blue&quot;, &quot;green&quot;), lty = 1) カイ2乗検定を行います。計算したカイ2乗統計量を再度確認しましょう。 chi_sq ## [1] 4.309764 付表8より，自由度1のカイ2乗分布において上側確率.05に対応する値は3.841なので統計的に有意な連関があったといえます。 上側確率.05に対応するカイ2乗値はqchisq()関数で求めることができます。 qchisq()関数は引数の自由度dfを指定することで，確率に対応するカイ2乗値を計算します。 qchisq(0.950, df = 1) ## [1] 3.841459 付表8と同じ値が出力されました。 Rでカイ2乗検定はchisq.test()関数で行うことができます。 chisq.test()関数はmatrix型のデータを与えることでクロス集計表のカイ2乗検定を行うことができます。今回dat_ABはmatrix型のデータなので，そのまま引数に指定してください。 chisq.test()関数はデフォルトで連続性の補正が行われるように設定されています。教科書の値と一致させるには，引数のcorrectをFALSEと指定してください。 chisq.test(dat_AB, correct = FALSE) ## ## Pearson&#39;s Chi-squared test ## ## data: dat_AB ## X-squared = 4.3098, df = 1, p-value = 0.03789 出力結果のX-squaredがカイ2乗統計量を示します。教科書に従って計算した値(chi_sq)と同じ値が出力されていることを確認してください。 計算されたカイ2乗統計量が(6.46)式の関係になっているか確認しましょう。 40 * (phi ^2) ## [1] 4.309764 先ほど計算したカイ2乗値(chi_sqの値)と同じ値が得られました。 "],
["連関の検定と比率差の検定の関係p-189-190.html", "6.5.4 連関の検定と比率差の検定の関係(P.189 - 190)", " 6.5.4 連関の検定と比率差の検定の関係(P.189 - 190) 表6-2のデータでカイ2乗統計量を求めましょう。 chisq.test(dat_A, correct = FALSE) ## ## Pearson&#39;s Chi-squared test ## ## data: dat_A ## X-squared = 3.75, df = 1, p-value = 0.05281 教科書と同様に3.75という値が計算できました。 最後に(6.47)式の関係になっているか確認します(表6-2のデータに対して求めた統計量\\(z\\)は，zというオブジェクトに代入されています)。 z ^2 ## [1] 3.75 同じ3.75という値が計算できました。 "],
["演習問題-6.html", "演習問題", " 演習問題 以下のコードを実行してください。 dat &lt;- read.csv(file = &quot;data/itsudatsu_data.csv&quot;) dat_M &lt;- subset(dat, sex == 1) dat_F &lt;- subset(dat, sex == 2) 問題1 教科書の第1節では，男子と女子の変化量について独立な2群の\\(t\\)検定を行いました。男子と女子の小6のときの逸脱行動得点について，独立な2群の\\(t\\)検定を行います。 男子と女子の小6のときの逸脱行動得点について，それぞれ平均値を求めてください。 問題2 男女における小6の逸脱行動得点の\\(t\\)値を教科書(6.7)式に基づいて計算してください。 問題3 問題2の結果が有意水準.50の両側検定で統計的に有意か判断してください。有意であれば「統計的に有意な差がみられた」，有意でなければ「統計的に有意な差はみられなかった」と解答してください。 問題4 男女の小6の逸脱行動得点について，平均値差の95%信頼区間を(6.13)式，(6.14)式に基づいて計算してください。 問題5 男女の小6の逸脱行動得点について，t.test()関数を使って独立な2群の\\(t\\)検定を行ってください。 問題6 男女の小6の逸脱行動得点について，効果量を求めてください。 問題7 女子の逸脱行動データにおいて，小6から中2にかけての逸脱行動得点の変化量(diff)に対して対応のある2群の\\(t\\)検定を行います。(6.26)式に従って，\\(t\\)値を計算してください。 問題8 問題7の結果が有意水準.50の両側検定で統計的に有意か判断してください。有意であれば「統計的に有意な差がみられた」，有意でなければ「統計的に有意な差はみられなかった」と解答してください。 問題9 女子の逸脱行動得点について，平均値差の95%信頼区間を(6.30)式，(6.31)式に基づいて計算してください。 問題10 女子の逸脱行動得点について，t.test()関数を使って対応のある2群の\\(t\\)検定を行ってください。 問題11 表6-2のデータ(dat_A)のカイ2乗統計量を，(6.40)式に従って計算してください。dat_Aは以下のコードを実行して作成してください。 dat_A &lt;- matrix(c(11, 9, 5, 15), ncol = 2, nrow = 2, byrow = TRUE) dimnames(dat_A) &lt;- list(c(&quot;男子&quot;,&quot;女子&quot;), c(&quot;ある&quot;,&quot;ない&quot;)) dat_A ## ある ない ## 男子 11 9 ## 女子 5 15 "]
]
